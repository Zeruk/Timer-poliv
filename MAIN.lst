MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001         LIST            p=16f876a
2007   3F3A           00002         __CONFIG        0x3F3A
                      00003         
                      00004 ;; переменные
  00000083            00005 STATUS          EQU             83h
  0000008B            00006 INTCON          EQU             8Bh
  00000085            00007 TRISA           EQU             85h
  00000086            00008 TRISB           EQU             86h
  00000087            00009 TRISC           EQU             87h
  00000005            00010 PORTA           EQU             05h
  00000006            00011 PORTB           EQU             06h
  00000007            00012 PORTC           EQU             07h
  00000002            00013 PCL                     EQU             02h
  0000001F            00014 ADCON0          EQU             1Fh
  0000009F            00015 ADCON1          EQU             9Fh
                      00016 ;; DS1302 константы
  00000002            00017 RST                     EQU             .2
  00000000            00018 SCLK            EQU             .0
  00000001            00019 IO                      EQU             .1
  00000082            00020 DS_W_MINUTES    EQU             82h
  00000083            00021 DS_R_MINUTES    EQU             83h
  00000084            00022 DS_W_HOUR       EQU             84h
  00000085            00023 DS_R_HOUR       EQU             85h
                      00024 ;DS_W_DAY       EQU             86h
                      00025 ;DS_R_DAY       EQU             87h
                      00026 ;DS_W_MONTH     EQU             88h
                      00027 ;DS_R_MONTH     EQU             89h
  0000008E            00028 DS_WP           EQU             8Eh
                      00029 ;;
  00000002            00030 B_MODE          EQU             .2
  00000003            00031 B_SELECT        EQU             .3
                      00032 ;;      Количество показов, чтобы избежать дребезга
  0000000A            00033 RATTLING_COUNT_SHOWING  EQU             .10                                             ;;;!!! ПРОТЕСТИР
                            ОВАТЬ !!!
  00000009            00034 COUNT_TAPS_MODE_CONST   EQU             .9
  00000007            00035 COUNT_TAPS_MODE_CONST1  EQU             .7
Warning[205]: Found directive in column 1. (CBLOCK)
                      00036 CBLOCK 0x20
  00000020            00037 IND1            ;; 0x20
  00000021            00038 IND2            ;; 0x21
  00000022            00039 IND3            ;; 0x22
  00000023            00040 IND4            ;; x023
  00000024            00041 IND_TEMP
  00000025            00042 IBLINKING       ;;      =00001110
  00000026            00043 IDOBLINK                ;; 0/1  
                      00044 ;;
  00000027            00045 COUNT_TAPS_MODE
                      00046 ;;ВРЕМЯ СЕЙЧАС
  00000028            00047 NOW_MINUTE
  00000029            00048 NOW_MINUTE10
  0000002A            00049 NOW_HOUR
  0000002B            00050 NOW_HOUR10
                      00051 ;NOW_DAY
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00052 ;NOW_DAY10
                      00053 ;NOW_MOUNTH
                      00054 ;NOW_MOUNTH10
                      00055 ;NOW_YEAR
                      00056 ;NOW_YEAR10
                      00057 ;;ДЛЯ ЗАДЕРЖКИ
  0000002C            00058 TIMER_COUNTER1
  0000002D            00059 TIMER_COUNTER2
  0000002E            00060 TIMER_COUNTER3
  0000002F            00061 TIMER_COUNTER4  ;;для моргания индикаторами
                      00062 ;;ПЕРЕДАЧА/ПРИЕМ БАЙТА
  00000030            00063 RW_BYTE         ;; управляющий байт
  00000031            00064 RW_BYTE1        ;; Принятый байт/ байт для передачи
                      00065 ;;ДЛЯ ОГРАНИЧЕНИЯ ВВОДА
Warning[205]: Found directive in column 1. (ENDC)
                      00066 ENDC
                      00067 ;;******************* конец переменных ********************
                      00068 
                      00069 ;;                              !!! Максимум 8 вызовов CALL !!!
                      00070 
Warning[205]: Found directive in column 1. (org)
0000                  00071 org 0
                      00072         ;;Инициализация
0000                  00073 init_lbl
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0000   0183           00074         CLRF            STATUS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0001   138B           00075         BCF                     INTCON,7                ;;запрет прерываний
0002   019F           00076         CLRF            ADCON0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0003   1303           00077         BCF                     STATUS,6                ;;первый бит выбора банка = 0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0004   1683           00078         BSF                     STATUS,5                ;;второй = 1   => bank #1
0005   3007           00079         MOVLW           B'00000111'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0006   009F           00080         MOVWF           ADCON1
                      00081         ;; порты: A,B,C
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0007   0185           00082         CLRF            TRISA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0008   1485           00083         BSF                     TRISA,IO
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0009   0186           00084         CLRF            TRISB
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000A   0187           00085         CLRF            TRISC
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000B   1507           00086         BSF                     TRISC,2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000C   1587           00087         BSF                     TRISC,3
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   1283           00088         BCF                     STATUS,5                ;;  BANK0
000E   0185           00089         CLRF            PORTA
000F   0186           00090         CLRF            PORTB
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0010   0187           00091         CLRF            PORTC
                      00092 
                      00093 
                      00094 ;; ///////////////////////////////////////////////////////////////////////
                      00095 ;; //////////////////////////////// Main /////////////////////////////////
                      00096 ;; ///////////////////////////////////////////////////////////////////////
0011                  00097 MAIN
0011   3000           00098         MOVLW           B'00000000'
0012   00A5           00099         MOVWF           IBLINKING
0013   3001           00100         MOVLW           B'00000001'
0014   00AF           00101         MOVWF           TIMER_COUNTER4
0015   3000           00102         MOVLW           .0
0016   00A0           00103         MOVWF           IND1
0017   00A1           00104         MOVWF           IND2
0018   00A2           00105         MOVWF           IND3
0019   00A3           00106         MOVWF           IND4
001A   3032           00107         MOVLW           .50
001B   20F4           00108         CALL            SHOWING_DELAY
001C   300A           00109         MOVLW           .10
001D   00A0           00110         MOVWF           IND1
001E   00A1           00111         MOVWF           IND2
001F   00A2           00112         MOVWF           IND3
0020   00A3           00113         MOVWF           IND4
0021   204B           00114         CALL            SHOWING
0022   1D07           00115         BTFSS           PORTC,B_MODE ;;проверка нажатия кнопки, если нажата,
0023   2821           00116         GOTO            $-2              ;;то следующая инструкция не выполняется
0024   295D           00117         GOTO            SHOWMENU
Warning[203]: Found opcode in column 1. (GOTO)
0025   2811           00118 GOTO    MAIN
                      00119 ;; ///////////////////////////////////////////////////////////////////////
                      00120 ;; ///////////////////////////////////////////////////////////////////////
                      00121 ;; ///////////////////////////////////////////////////////////////////////
                      00122 
                      00123 ;; **************************** Подпрограммы **************************** 
                      00124 
                      00125 
0026                  00126 CHAR_TABLE
0026   0782           00127         ADDWF           PCL,1
0027   34C0           00128         RETLW           B'11000000';0
0028   34F9           00129         RETLW           B'11111001';1
0029   34A4           00130         RETLW           B'10100100';2
002A   34B0           00131         RETLW           B'10110000';3
002B   3499           00132         RETLW           B'10011001';4
002C   3492           00133         RETLW           B'10010010';5
002D   3482           00134         RETLW           B'10000010';6
002E   34F8           00135         RETLW           B'11111000';7
002F   3480           00136         RETLW           B'10000000';8
0030   3490           00137         RETLW           B'10010000';9
0031   34FF           00138         RETLW           B'11111111';10
0032   3488           00139         RETLW           B'10001000';A   11
0033   34C6           00140         RETLW           B'11000110';C   12
0034   3486           00141         RETLW           B'10000110';E   13
0035   348E           00142         RETLW           B'10001110';F   14
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0036   34C2           00143         RETLW           B'11000010';G   15
0037   3489           00144         RETLW           B'10001001';H   16
0038   34C7           00145         RETLW           B'11000111';L   17
0039   34AB           00146         RETLW           B'10101011';N   18
003A   348C           00147         RETLW           B'10001100';P   19
003B   34C1           00148         RETLW           B'11000001';U   20
003C   3482           00149         RETLW           B'10000010';Б   21
003D   3491           00150         RETLW           B'10010001';У   22
003E   3499           00151         RETLW           B'10011001';Ч   23
                      00152 
Warning[203]: Found opcode in column 1. (RETURN)
003F   0008           00153 RETURN
                      00154 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0040                  00155 DELAY  ;; 500 циклов
0040   30DD           00156         MOVLW           .221
0041   00AC           00157         MOVWF           TIMER_COUNTER1
0042   300D           00158         MOVLW           .13
0043   00AD           00159         MOVWF           TIMER_COUNTER2
0044   0BAC           00160         DECFSZ          TIMER_COUNTER1,1
0045   2844           00161         GOTO            $-1
0046   0BAD           00162         DECFSZ          TIMER_COUNTER2,1
0047   2844           00163         GOTO            $-3
0048   0000           00164         NOP
0049   0000           00165         NOP
Warning[203]: Found opcode in column 1. (RETURN)
004A   0008           00166 RETURN
                      00167 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
004B                  00168 SHOWING
Message[305]: Using default destination of 1 (file).
004B   0BAF           00169         DECFSZ          TIMER_COUNTER4
004C   2850           00170         GOTO            $+4
004D   09A6           00171         COMF            IDOBLINK,1
004E   300A           00172         MOVLW           .10
004F   00AF           00173         MOVWF           TIMER_COUNTER4
                      00174         
0050   1C26           00175         BTFSS           IDOBLINK,0              ;;--
0051   2853           00176         GOTO            $+2                             ;;;ДЛЯ МОРГАНИЯ
0052   1DA5           00177         BTFSS           IBLINKING,3             ;;__
0053   1787           00178         BSF                     PORTC,7
0054   0820           00179         MOVF            IND1,0
0055   2026           00180         CALL            CHAR_TABLE
0056   0086           00181         MOVWF           PORTB
0057   2040           00182         CALL            DELAY
0058   1387           00183         BCF                     PORTC,7
                      00184 
0059   1C26           00185         BTFSS           IDOBLINK,0              ;;--
005A   285C           00186         GOTO            $+2                             ;;;ДЛЯ МОРГАНИЯ
005B   1D25           00187         BTFSS           IBLINKING,2             ;;__
005C   1707           00188         BSF                     PORTC,6
005D   0821           00189         MOVF            IND2,0
005E   2026           00190         CALL            CHAR_TABLE
005F   0086           00191         MOVWF           PORTB
0060   2040           00192         CALL            DELAY
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0061   1307           00193         BCF                     PORTC,6
                      00194 
0062   1C26           00195         BTFSS           IDOBLINK,0              ;;--
0063   2865           00196         GOTO            $+2                             ;;;ДЛЯ МОРГАНИЯ
0064   1CA5           00197         BTFSS           IBLINKING,1             ;;__
0065   1687           00198         BSF                     PORTC,5
0066   0822           00199         MOVF            IND3,0
0067   2026           00200         CALL            CHAR_TABLE
0068   0086           00201         MOVWF           PORTB
0069   2040           00202         CALL            DELAY
006A   1287           00203         BCF                     PORTC,5
                      00204 
006B   1C26           00205         BTFSS           IDOBLINK,0              ;;--
006C   286E           00206         GOTO            $+2                             ;;;ДЛЯ МОРГАНИЯ
006D   1C25           00207         BTFSS           IBLINKING,0             ;;__
006E   1607           00208         BSF                     PORTC,4
006F   0823           00209         MOVF            IND4,0
0070   2026           00210         CALL            CHAR_TABLE
0071   0086           00211         MOVWF           PORTB
0072   2040           00212         CALL            DELAY
0073   1207           00213         BCF                     PORTC,4
Warning[203]: Found opcode in column 1. (RETURN)
0074   0008           00214 RETURN
                      00215 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0075                  00216 TRANSMISSION_IN ;;ПРИЕМ ОТ DS1302
0075   3083           00217         MOVLW           DS_R_MINUTES
0076   00B0           00218         MOVWF           RW_BYTE
0077   20B4           00219         CALL            CONNECT_DS
0078   20C7           00220         CALL            READ_BYTE
0079   0831           00221         MOVF            RW_BYTE1,0
007A   390F           00222         ANDLW           B'00001111'
007B   00A8           00223         MOVWF           NOW_MINUTE              ;;<**** M
                      00224 
Message[305]: Using default destination of 1 (file).
007C   0CB1           00225         RRF                     RW_BYTE1
Message[305]: Using default destination of 1 (file).
007D   0CB1           00226         RRF                     RW_BYTE1
Message[305]: Using default destination of 1 (file).
007E   0CB1           00227         RRF                     RW_BYTE1
Message[305]: Using default destination of 1 (file).
007F   0CB1           00228         RRF                     RW_BYTE1
0080   0831           00229         MOVF            RW_BYTE1,0
0081   390F           00230         ANDLW           B'00001111'
0082   00A9           00231         MOVWF           NOW_MINUTE10            ;;<**** 10M
                      00232 
0083   3085           00233         MOVLW           DS_R_HOUR
0084   00B0           00234         MOVWF           RW_BYTE
0085   20B4           00235         CALL            CONNECT_DS
0086   20C7           00236         CALL            READ_BYTE
0087   0831           00237         MOVF            RW_BYTE1,0
0088   390F           00238         ANDLW           B'00001111'
0089   00AA           00239         MOVWF           NOW_HOUR                ;;<**** H
                      00240 
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[305]: Using default destination of 1 (file).
008A   0CB1           00241         RRF                     RW_BYTE1
Message[305]: Using default destination of 1 (file).
008B   0CB1           00242         RRF                     RW_BYTE1
Message[305]: Using default destination of 1 (file).
008C   0CB1           00243         RRF                     RW_BYTE1
Message[305]: Using default destination of 1 (file).
008D   0CB1           00244         RRF                     RW_BYTE1
008E   0831           00245         MOVF            RW_BYTE1,0
008F   3903           00246         ANDLW           B'00000011'
0090   00AB           00247         MOVWF           NOW_HOUR10              ;;<**** 10H
                      00248 
                      00249 ;       MOVLW           DS_R_DAY
                      00250 ;       MOVWF           RW_BYTE
                      00251 ;       CALL            CONNECT_DS
                      00252 ;       CALL            READ_BYTE
                      00253 ;       MOVF            RW_BYTE1,0
                      00254 ;       ANDLW           B'00001111'
                      00255 ;       MOVWF           NOW_DAY                 ;; DAY
                      00256 ;       
                      00257 ;       RRF                     RW_BYTE1
                      00258 ;       RRF                     RW_BYTE1
                      00259 ;       RRF                     RW_BYTE1
                      00260 ;       RRF                     RW_BYTE1
                      00261 ;       MOVF            RW_BYTE1,0
                      00262 ;       ANDLW           B'0000011'
                      00263 ;       MOVWF           NOW_DAY10       ;; 10DAY
Warning[203]: Found opcode in column 1. (RETURN)
0091   0008           00264 RETURN
                      00265 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0092                  00266 TRANSMISSION_OUT  ;;ПЕРЕДАЧА данных
0092   308E           00267         MOVLW           DS_WP   
0093   00B0           00268         MOVWF           RW_BYTE
0094   20B4           00269         CALL            CONNECT_DS
0095   3000           00270         MOVLW           b'00000000'     
0096   00B1           00271         MOVWF           RW_BYTE1
0097   20DF           00272         CALL            WRITE_BYTE
                      00273 ;; очистили бит защиты записи
                      00274 
                      00275 ;; записываем в DS минуты 
0098   0829           00276         MOVF            NOW_MINUTE10,0
0099   00B1           00277         MOVWF           RW_BYTE1
009A   0DB1           00278         RLF                     RW_BYTE1,1
009B   0DB1           00279         RLF                     RW_BYTE1,1
009C   0DB1           00280         RLF                     RW_BYTE1,1
009D   0DB1           00281         RLF                     RW_BYTE1,1
009E   0828           00282         MOVF            NOW_MINUTE,0
009F   04B1           00283         IORWF           RW_BYTE1,1
00A0   3082           00284         MOVLW           DS_W_MINUTES
00A1   00B0           00285         MOVWF           RW_BYTE
00A2   20B4           00286         CALL            CONNECT_DS
00A3   20DF           00287         CALL            WRITE_BYTE
                      00288         
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00289 ; Часы:
00A4   082B           00290         MOVF            NOW_HOUR10,0
00A5   00B1           00291         MOVWF           RW_BYTE1        ;00000001
00A6   0DB1           00292         RLF                     RW_BYTE1,1      ;00000010
00A7   0DB1           00293         RLF                     RW_BYTE1,1      ;00000100
00A8   0DB1           00294         RLF                     RW_BYTE1,1      ;00001000
00A9   0DB1           00295         RLF                     RW_BYTE1,1      ;00010000
00AA   082A           00296         MOVF            NOW_HOUR,0
00AB   04B1           00297         IORWF           RW_BYTE1,1
00AC   13B1           00298         BCF                     RW_BYTE1,7
00AD   3084           00299         MOVLW           DS_W_HOUR
00AE   00B0           00300         MOVWF           RW_BYTE
00AF   20B4           00301         CALL            CONNECT_DS
00B0   20DF           00302         CALL            WRITE_BYTE
                      00303         
00B1   1105           00304         BCF                     PORTA,RST
00B2   1085           00305         BCF                     PORTA,IO
Warning[203]: Found opcode in column 1. (RETURN)
00B3   0008           00306 RETURN
                      00307 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00B4                  00308 CONNECT_DS
00B4   1505           00309         BSF                     PORTA,RST
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B5   1303           00310         BCF                     STATUS,6                ;;первый бит выбора банка = 0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B6   1683           00311         BSF                     STATUS,5                ;;второй = 1   => bank #1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B7   1085           00312         BCF                     TRISA,IO                ;;0=output
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B8   1283           00313         BCF                     STATUS,5                ;;второй = 0   => bank #0
Warning[207]: Found label after column 1. (CONNECT_DS_BEFORE_SETBIT)
00B9                  00314                 CONNECT_DS_BEFORE_SETBIT
00B9   1005           00315                 BCF                     PORTA,SCLK ;;4 тика между включением и выключением Sclk = 1мкс п
                            ри 4Мц
00BA   1C30           00316                 BTFSS           RW_BYTE,0
00BB   28BE           00317                 GOTO            CONNECT_DS_BEFORE_SETBIT1
00BC   1485           00318                 BSF                     PORTA,IO
00BD   28C0           00319                 GOTO            CONNECT_DS_AFTER_SETBIT
Warning[207]: Found label after column 1. (CONNECT_DS_BEFORE_SETBIT1)
00BE                  00320                         CONNECT_DS_BEFORE_SETBIT1
00BE   1085           00321                         BCF                     PORTA,IO
00BF   0000           00322                         NOP
Warning[207]: Found label after column 1. (CONNECT_DS_AFTER_SETBIT)
00C0                  00323                 CONNECT_DS_AFTER_SETBIT
00C0   1405           00324                 BSF                     PORTA,SCLK
00C1   0CB0           00325                 RRF                     RW_BYTE,1               
00C2   13B0           00326                 BCF                     RW_BYTE,7
00C3   0AB0           00327                 INCF            RW_BYTE,1
00C4   0BB0           00328                 DECFSZ          RW_BYTE,1
00C5   28B9           00329                 GOTO            CONNECT_DS_BEFORE_SETBIT
Warning[203]: Found opcode in column 1. (RETURN)
00C6   0008           00330 RETURN
                      00331 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C7                  00332 READ_BYTE
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C7   1303           00333         BCF                     STATUS,6                ;;первый бит выбора банка = 0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C8   1683           00334         BSF                     STATUS,5                ;;второй = 1   => bank #1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C9   1485           00335         BSF                     TRISA,IO                ;;1=input
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00CA   1283           00336         BCF                     STATUS,5                ;;второй = 0   => bank #0
00CB   3008           00337         MOVLW           .8
00CC   00AC           00338         MOVWF           TIMER_COUNTER1
00CD   01B1           00339         CLRF            RW_BYTE1
00CE                  00340 READ_BYTE_1
Message[305]: Using default destination of 1 (file).
00CE   0CB1           00341         RRF                     RW_BYTE1
00CF   1005           00342         BCF                     PORTA,SCLK
00D0   0000           00343         NOP
00D1   1885           00344         BTFSC           PORTA,IO
00D2   28D5           00345         GOTO            READ_BYTE_BEFORE
00D3   13B1           00346         BCF                     RW_BYTE1,7
00D4   28D6           00347         GOTO            READ_BYTE_AFTER
00D5                  00348 READ_BYTE_BEFORE
00D5   17B1           00349         BSF                     RW_BYTE1,7
00D6                  00350 READ_BYTE_AFTER
00D6   1405           00351         BSF                     PORTA,SCLK
00D7   0000           00352         NOP
00D8   0000           00353         NOP
00D9   0BAC           00354         DECFSZ          TIMER_COUNTER1,1
00DA   28CE           00355         GOTO            READ_BYTE_1
                      00356 
00DB   1005           00357         BCF                     PORTA, SCLK
00DC   1105           00358         BCF                     PORTA,RST
00DD   1085           00359         BCF                     PORTA,IO
Warning[203]: Found opcode in column 1. (RETURN)
00DE   0008           00360 RETURN
                      00361 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00DF                  00362 WRITE_BYTE
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00DF   1303           00363         BCF                     STATUS,6                ;;первый бит выбора банка = 0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00E0   1683           00364         BSF                     STATUS,5                ;;второй = 1   => bank #1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00E1   1085           00365         BCF                     TRISA,IO                ;; IO = 0 = output
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00E2   1283           00366         BCF                     STATUS,5                ;;второй = 0   => bank #0
                      00367 
00E3   3008           00368         MOVLW           .8
00E4   00AC           00369         MOVWF           TIMER_COUNTER1
                      00370 
                      00371 ; RW_BYTE1 - Байт с данными
Message[305]: Using default destination of 1 (file).
00E5   0BAC           00372         DECFSZ          TIMER_COUNTER1
00E6   28E8           00373         GOTO            $+2
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00E7   0008           00374         RETURN
00E8   1005           00375         BCF                     PORTA,SCLK
00E9   0000           00376         NOP
00EA   1085           00377         BCF                     PORTA,IO
00EB   1FB1           00378         BTFSS           RW_BYTE1,7
00EC   28EE           00379         GOTO            $+2
00ED   1485           00380         BSF                     PORTA,IO
00EE   0000           00381         NOP
00EF   1405           00382         BSF                     PORTA,SCLK
00F0   0000           00383         NOP
Message[305]: Using default destination of 1 (file).
00F1   0CB1           00384         RRF                     RW_BYTE1
00F2   28E5           00385         GOTO            $-.13
Warning[203]: Found opcode in column 1. (RETURN)
00F3   0008           00386 RETURN
                      00387 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00F4                  00388 SHOWING_DELAY           ;;      W ЦИКЛОВ ПОКАЗА ИЗОБРАЖЕНИЯ
00F4   00AE           00389         MOVWF           TIMER_COUNTER3
00F5                  00390 SHOWING_DELAY_before_cycle1
00F5   204B           00391         CALL            SHOWING
Message[305]: Using default destination of 1 (file).
00F6   0BAE           00392         DECFSZ          TIMER_COUNTER3
00F7   28F5           00393         GOTO            SHOWING_DELAY_before_cycle1
00F8   0000           00394         NOP
Warning[203]: Found opcode in column 1. (RETURN)
00F9   0008           00395 RETURN
                      00396 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00397 
00FA                  00398 BUTTON_MODE_PROCESSING ;;После обнаружения нажатия
00FA   300A           00399         MOVLW           RATTLING_COUNT_SHOWING  ;;защита от дребезга
00FB   20F4           00400         CALL            SHOWING_DELAY
00FC   204B           00401         CALL            SHOWING
00FD   1907           00402         BTFSC           PORTC,B_MODE
00FE   28FC           00403         GOTO            $-2
00FF   300A           00404         MOVLW           RATTLING_COUNT_SHOWING  ;;защита от дребезга
0100   20F4           00405         CALL            SHOWING_DELAY   
Warning[203]: Found opcode in column 1. (RETURN)
0101   0008           00406 RETURN
0102                  00407 BUTTON_SELECT_PROCESSING ;;После обнаружения нажатия
0102   300A           00408         MOVLW           RATTLING_COUNT_SHOWING  ;;защита от дребезга
0103   20F4           00409         CALL            SHOWING_DELAY
0104   204B           00410         CALL            SHOWING
0105   1987           00411         BTFSC           PORTC,B_SELECT
0106   2904           00412         GOTO            $-2
0107   300A           00413         MOVLW           RATTLING_COUNT_SHOWING  ;;защита от дребезга
0108   20F4           00414         CALL            SHOWING_DELAY   
Warning[203]: Found opcode in column 1. (RETURN)
0109   0008           00415 RETURN
                      00416 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00417 ;;                                      ПРОЦЕДУРА УСТАНОВКИ ВРЕМЕНИ                                     
                                            ;;
                      00418 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
010A                  00419 SET_TIME;;Установка времени                             
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

010A   2102           00420         CALL            BUTTON_SELECT_PROCESSING
010B   2075           00421         CALL            TRANSMISSION_IN
010C   0000           00422         NOP
010D   0828           00423         MOVF            NOW_MINUTE,0
010E   00A3           00424         MOVWF           IND4
010F   0829           00425         MOVF            NOW_MINUTE10,0
0110   00A2           00426         MOVWF           IND3
0111   082A           00427         MOVF            NOW_HOUR,0
0112   00A1           00428         MOVWF           IND2
0113   082B           00429         MOVF            NOW_HOUR10,0
0114   00A0           00430         MOVWF           IND1
0115   3001           00431         MOVLW           B'00000001'
0116   00A5           00432         MOVWF           IBLINKING               ;;МОРГАЕТ ЧЕТВЕРТЫЙ ИНДИКАТОР
0117                  00433 SET_TIME_MIN
0117   204B           00434         CALL            SHOWING
0118   1D87           00435         BTFSS           PORTC,B_SELECT
0119   2924           00436         GOTO            $+.11
011A   0AA3           00437         INCF            IND4,1 ;; СОХРАНЯЕТСЯ В F
011B   0823           00438         MOVF            IND4,0
011C   00A4           00439         MOVWF           IND_TEMP
011D   3009           00440         MOVLW           .9
011E   02A4           00441         SUBWF           IND_TEMP,1
Message[305]: Using default destination of 1 (file).
011F   0BA4           00442         DECFSZ          IND_TEMP
0120   2923           00443         GOTO            $+3
0121   3000           00444         MOVLW           .0
0122   00A3           00445         MOVWF           IND4
0123   2102           00446         CALL            BUTTON_SELECT_PROCESSING
0124   1D07           00447         BTFSS           PORTC,B_MODE
0125   2917           00448         GOTO            SET_TIME_MIN
Message[305]: Using default destination of 1 (file).
0126   0DA5           00449         RLF                     IBLINKING               ;;МОРГАЕТ ТРЕТИЙ ИНД
0127   20FA           00450         CALL    BUTTON_MODE_PROCESSING
                      00451 
0128                  00452 SET_TIME_MIN10
0128   204B           00453         CALL            SHOWING
0129   1D87           00454         BTFSS           PORTC,B_SELECT
012A   2935           00455         GOTO            $+.11
012B   0AA2           00456         INCF            IND3,1 ;; СОХРАНЯЕТСЯ В F
012C   0822           00457         MOVF            IND3,0
012D   00A4           00458         MOVWF           IND_TEMP
012E   3005           00459         MOVLW           .5
012F   02A4           00460         SUBWF           IND_TEMP,1
Message[305]: Using default destination of 1 (file).
0130   0BA4           00461         DECFSZ          IND_TEMP
0131   2934           00462         GOTO            $+3
0132   3000           00463         MOVLW           .0
0133   00A2           00464         MOVWF           IND3
0134   2102           00465         CALL            BUTTON_SELECT_PROCESSING
0135   1D07           00466         BTFSS           PORTC,B_MODE
0136   2928           00467         GOTO            SET_TIME_MIN10
0137   300C           00468         MOVLW           B'00001100'
0138   00A5           00469         MOVWF           IBLINKING               ;;МОРГАЕТ ВТОРОЙ И ПЕРВЫЙ ИНД
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0139   20FA           00470         CALL    BUTTON_MODE_PROCESSING
013A                  00471 SET_TIME_HOUR
013A   204B           00472         CALL            SHOWING
013B   1D87           00473         BTFSS           PORTC,B_SELECT
013C   2957           00474         GOTO            $+.27
013D   0AA1           00475         INCF            IND2,1 ;; СОХРАНЯЕТСЯ В F
013E   0821           00476         MOVF            IND2,0
013F   00A4           00477         MOVWF           IND_TEMP
0140   3009           00478         MOVLW           .9                                              
0141   02A4           00479         SUBWF           IND_TEMP,1                                      
Message[305]: Using default destination of 1 (file).
0142   0BA4           00480         DECFSZ          IND_TEMP
0143   2947           00481         GOTO            $+.4
0144   3000           00482         MOVLW           .0
0145   00A1           00483         MOVWF           IND2
0146   0AA0           00484         INCF            IND1,1
0147   0820           00485         MOVF            IND1,0
0148   00A4           00486         MOVWF           IND_TEMP
0149   3001           00487         MOVLW           .1                                                      
014A   02A4           00488         SUBWF           IND_TEMP,1      ;; 1я цифра - 2                         
Message[305]: Using default destination of 1 (file).
014B   0BA4           00489         DECFSZ          IND_TEMP
014C   2956           00490         GOTO            $+.10
014D   0821           00491         MOVF            IND2,0
014E   00A4           00492         MOVWF           IND_TEMP        
014F   3003           00493         MOVLW           .3
0150   02A4           00494         SUBWF           IND_TEMP,1      ;; 2я цифра - 4                         
Message[305]: Using default destination of 1 (file).
0151   0BA4           00495         DECFSZ          IND_TEMP
0152   2956           00496         GOTO            $+.4
0153   3000           00497                 MOVLW           .0
0154   00A0           00498                 MOVWF           IND1
0155   00A1           00499                 MOVWF           IND2
0156   2102           00500         CALL            BUTTON_SELECT_PROCESSING
0157   1D07           00501         BTFSS           PORTC,B_MODE
0158   293A           00502         GOTO            SET_TIME_HOUR
                      00503 
                      00504 ;;      здесь должно быть TRANSMITION_OUT
0159   3000           00505         MOVLW           .0
015A   00A5           00506         MOVWF           IBLINKING
015B   2092           00507         CALL            TRANSMISSION_OUT
Warning[203]: Found opcode in column 1. (RETURN)
015C   0008           00508 RETURN
                      00509 
                      00510 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00511 ;;
                      00512 ;;
                      00513 ;;                                              Структура меню:
                      00514 ;;
                      00515 ;;
                      00516 ;;                                                                        Вход
                      00517 ;;                                                                              |
                      00518 ;;              установка времени включения             |               установка времени/даты
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00519 ;;                                                                              |                       
                                    минуты
                      00520 ;;                      1       |       2       |       3                       |                       
                            десятки минут
                      00521 ;;                                                                              |                       
                                    часы
                      00522 ;;                                                                              |                       
                            десятки часов
                      00523 ;;                                                                              |                       
                                    дата
                      00524 ;;                                                                              |                       
                                месяц
                      00525 ;;                                                                              |                       
                                    год
                      00526 ;;
                      00527 ;;
                      00528 ;;              операция ввода, возвращает в W результат для каждой цифры
                      00529 ;;
                      00530 ;;
                      00531 ;;
                      00532 ;;
                      00533 ;;
                      00534 ;;
                      00535 
015D                  00536 SHOWMENU
015D   3009           00537         MOVLW           COUNT_TAPS_MODE_CONST   ;;      устанавливается счетчик нажатий 
                      00538                                                 ;;      кнопки mode, когда = 0, выход на уровень вверх.
015E   00A7           00539         MOVWF           COUNT_TAPS_MODE
                      00540 
015F   3010           00541         MOVLW           .16
0160   00A1           00542         MOVWF           IND2
0161   3001           00543         MOVLW           .1
0162   00A2           00544         MOVWF           IND3                    ;; "HI"
0163   300A           00545         MOVLW           .10
0164   00A0           00546         MOVWF           IND1
0165   00A3           00547         MOVWF           IND4
                      00548 ;;      50 циклов показа картинки
0166   3032           00549         MOVLW           .50
0167   20F4           00550         CALL            SHOWING_DELAY
0168   204B           00551         CALL            SHOWING
0169   1907           00552         BTFSC           PORTC,B_MODE
016A   2968           00553         GOTO            $-2
016B   300A           00554         MOVLW           RATTLING_COUNT_SHOWING
016C   20F4           00555         CALL            SHOWING_DELAY           ;;ОТПУСТИЛИ КНОПКУ
Warning[207]: Found label after column 1. (SHOWMENU_before_transmit)
016D                  00556         SHOWMENU_before_transmit
016D   2075           00557                 CALL            TRANSMISSION_IN
016E   0000           00558                 NOP
016F   0828           00559                 MOVF            NOW_MINUTE,0
0170   00A3           00560                 MOVWF           IND4
0171   0829           00561                 MOVF            NOW_MINUTE10,0
0172   00A2           00562                 MOVWF           IND3
0173   082A           00563                 MOVF            NOW_HOUR,0
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0174   00A1           00564                 MOVWF           IND2
0175   082B           00565                 MOVF            NOW_HOUR10,0
0176   00A0           00566                 MOVWF           IND1
0177   3003           00567                 MOVLW           .3
0178   20F4           00568                 CALL            SHOWING_DELAY
0179   1D07           00569                 BTFSS           PORTC,B_MODE
017A   296D           00570                 GOTO            SHOWMENU_before_transmit                
017B                  00571 SHOWMENU_change_time
017B   3008           00572         MOVLW           .8      
017C   00A0           00573         MOVWF           IND1
017D   3013           00574         MOVLW           .19     
017E   00A1           00575         MOVWF           IND2
017F   300D           00576         MOVLW           .13     
0180   00A2           00577         MOVWF           IND3
0181   300A           00578         MOVLW           .10     
0182   00A3           00579         MOVWF           IND4
                      00580 
Message[305]: Using default destination of 1 (file).
0183   0BA7           00581         DECFSZ          COUNT_TAPS_MODE
0184   2986           00582         GOTO            $+2
0185   2811           00583         GOTO            MAIN
0186   20FA           00584         CALL            BUTTON_MODE_PROCESSING
0187   204B           00585         CALL            SHOWING
0188   1D07           00586         BTFSS           PORTC,B_MODE
0189   298B           00587         GOTO            $+2     
018A   298F           00588         GOTO            SHOWMENU_change_shedule
018B   1D87           00589         BTFSS           PORTC,B_SELECT
018C   2987           00590         GOTO            $-5
                      00591 ;;
018D   210A           00592         CALL            SET_TIME
018E   296D           00593         GOTO            SHOWMENU_before_transmit
                      00594 
018F                  00595 SHOWMENU_change_shedule
018F   3013           00596         MOVLW           .19     
0190   00A0           00597         MOVWF           IND1
0191   300D           00598         MOVLW           .13     
0192   00A1           00599         MOVWF           IND2
0193   300A           00600         MOVLW           .10     
0194   00A2           00601         MOVWF           IND3
0195   300A           00602         MOVLW           .10     
0196   00A3           00603         MOVWF           IND4
                      00604 
Message[305]: Using default destination of 1 (file).
0197   0BA7           00605         DECFSZ          COUNT_TAPS_MODE
0198   299A           00606         GOTO            $+2
0199   2811           00607         GOTO            MAIN
019A   20FA           00608         CALL            BUTTON_MODE_PROCESSING
019B   204B           00609         CALL            SHOWING
019C   1D07           00610         BTFSS           PORTC,B_MODE
019D   299B           00611         GOTO            $-2
019E   299F           00612         GOTO SHOWMENU_reset
                      00613 
019F                  00614 SHOWMENU_reset
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

019F   300C           00615         MOVLW           .12     
01A0   00A0           00616         MOVWF           IND1
01A1   3015           00617         MOVLW           .21     
01A2   00A1           00618         MOVWF           IND2
01A3   3013           00619         MOVLW           .19     
01A4   00A2           00620         MOVWF           IND3
01A5   3000           00621         MOVLW           .0      
01A6   00A3           00622         MOVWF           IND4
                      00623 
Message[305]: Using default destination of 1 (file).
01A7   0BA7           00624         DECFSZ          COUNT_TAPS_MODE
01A8   29AA           00625         GOTO            $+2
01A9   2811           00626         GOTO            MAIN
01AA   20FA           00627         CALL            BUTTON_MODE_PROCESSING
01AB   204B           00628         CALL            SHOWING
01AC   1D07           00629         BTFSS           PORTC,B_MODE
01AD   29AB           00630         GOTO            $-2
01AE   29AF           00631         GOTO            SHOWMENU_manual_control
                      00632 
01AF                  00633 SHOWMENU_manual_control
01AF   3013           00634         MOVLW           .19     
01B0   00A0           00635         MOVWF           IND1
01B1   3016           00636         MOVLW           .22     
01B2   00A1           00637         MOVWF           IND2
01B3   3017           00638         MOVLW           .23     
01B4   00A2           00639         MOVWF           IND3
01B5   3010           00640         MOVLW           .16     
01B6   00A3           00641         MOVWF           IND4
                      00642         
Message[305]: Using default destination of 1 (file).
01B7   0BA7           00643         DECFSZ          COUNT_TAPS_MODE
01B8   29BA           00644         GOTO            $+2
01B9   2811           00645         GOTO            MAIN
01BA   20FA           00646         CALL            BUTTON_MODE_PROCESSING
01BB   204B           00647         CALL            SHOWING
01BC   1D07           00648         BTFSS           PORTC,B_MODE
01BD   29BB           00649         GOTO            $-2
Warning[203]: Found opcode in column 1. (GOTO)
01BE   297B           00650 GOTO SHOWMENU_change_time
                      00651 
Warning[203]: Found opcode in column 1. (GOTO)
01BF   2811           00652 GOTO    MAIN
Warning[205]: Found directive in column 1. (end)
                      00653 end
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE 15


SYMBOL TABLE
  LABEL                             VALUE 

ADCON0                            0000001F
ADCON1                            0000009F
BUTTON_MODE_PROCESSING            000000FA
BUTTON_SELECT_PROCESSING          00000102
B_MODE                            00000002
B_SELECT                          00000003
CHAR_TABLE                        00000026
CONNECT_DS                        000000B4
CONNECT_DS_AFTER_SETBIT           000000C0
CONNECT_DS_BEFORE_SETBIT          000000B9
CONNECT_DS_BEFORE_SETBIT1         000000BE
COUNT_TAPS_MODE                   00000027
COUNT_TAPS_MODE_CONST             00000009
COUNT_TAPS_MODE_CONST1            00000007
DELAY                             00000040
DS_R_HOUR                         00000085
DS_R_MINUTES                      00000083
DS_WP                             0000008E
DS_W_HOUR                         00000084
DS_W_MINUTES                      00000082
IBLINKING                         00000025
IDOBLINK                          00000026
IND1                              00000020
IND2                              00000021
IND3                              00000022
IND4                              00000023
IND_TEMP                          00000024
INTCON                            0000008B
IO                                00000001
MAIN                              00000011
NOW_HOUR                          0000002A
NOW_HOUR10                        0000002B
NOW_MINUTE                        00000028
NOW_MINUTE10                      00000029
PCL                               00000002
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
RATTLING_COUNT_SHOWING            0000000A
READ_BYTE                         000000C7
READ_BYTE_1                       000000CE
READ_BYTE_AFTER                   000000D6
READ_BYTE_BEFORE                  000000D5
RST                               00000002
RW_BYTE                           00000030
RW_BYTE1                          00000031
SCLK                              00000000
SET_TIME                          0000010A
SET_TIME_HOUR                     0000013A
SET_TIME_MIN                      00000117
SET_TIME_MIN10                    00000128
SHOWING                           0000004B
SHOWING_DELAY                     000000F4
MPASM  5.37                          MAIN.ASM   4-25-2017  10:35:14         PAGE 16


SYMBOL TABLE
  LABEL                             VALUE 

SHOWING_DELAY_before_cycle1       000000F5
SHOWMENU                          0000015D
SHOWMENU_before_transmit          0000016D
SHOWMENU_change_shedule           0000018F
SHOWMENU_change_time              0000017B
SHOWMENU_manual_control           000001AF
SHOWMENU_reset                    0000019F
STATUS                            00000083
TIMER_COUNTER1                    0000002C
TIMER_COUNTER2                    0000002D
TIMER_COUNTER3                    0000002E
TIMER_COUNTER4                    0000002F
TRANSMISSION_IN                   00000075
TRANSMISSION_OUT                  00000092
TRISA                             00000085
TRISB                             00000086
TRISC                             00000087
WRITE_BYTE                        000000DF
__16F876A                         00000001
__DEBUG                           1
init_lbl                          00000000


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2000 : -------X-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:   448
Program Memory Words Free:  7744


Errors   :     0
Warnings :    23 reported,     0 suppressed
Messages :    47 reported,     0 suppressed

